<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Көксерек: Зияткерлік Ойын Шоуы</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto+Mono:wght@400;700&family=Inter:wght@300;400;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a;
            color: white;
            overflow: hidden; /* Prevent body scroll, handle inside main */
        }
        .font-display {
            font-family: 'Orbitron', sans-serif;
        }
        .font-mono {
            font-family: 'Roboto Mono', monospace;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
        }
        ::-webkit-scrollbar-thumb {
            background: #06b6d4;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #0891b2;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        
        @keyframes loading {
            0% { width: 0%; }
            100% { width: 100%; }
        }
        .animate-loading {
            animation: loading 2s ease-in-out infinite;
        }

        /* Glassmorphism utilities */
        .glass {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(6, 182, 212, 0.3);
        }
        
        .active-tab {
            background: rgba(6, 182, 212, 0.2);
            color: #22d3ee;
            box-shadow: 0 0 20px rgba(6, 182, 212, 0.3);
            border: 1px solid rgba(6, 182, 212, 0.5);
            transform: translateY(-4px);
        }

        /* Hide sections by default */
        .section-content {
            display: none;
        }
        .section-content.active {
            display: block;
        }
    </style>
</head>
<body class="h-screen flex flex-col relative selection:bg-cyan-500 selection:text-black">

    <!-- Background Layers -->
    <div class="fixed inset-0 z-0">
        <!-- Wolf Background Image -->
        <div class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1565192372309-883a936a43d9?q=80&w=2070&auto=format&fit=crop')] bg-cover bg-center opacity-40"></div>
        <div class="absolute inset-0 bg-gradient-to-t from-gray-900 via-gray-900/80 to-transparent"></div>
        <div class="absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-transparent via-black/40 to-black"></div>
        <!-- Noise overlay removed as per "remove other picture" request or kept transparent -->
        <div class="absolute inset-0 opacity-10" style="background-image: url('data:image/svg+xml,%3Csvg viewBox=%220 0 200 200%22 xmlns=%22http://www.w3.org/2000/svg%22%3E%3Cfilter id=%22noiseFilter%22%3E%3CfeTurbulence type=%22fractalNoise%22 baseFrequency=%220.65%22 numOctaves=%223%22 stitchTiles=%22stitch%22/%3E%3C/filter%3E%3Crect width=%22100%25%22 height=%22100%25%22 filter=%22url(%23noiseFilter)%22/%3E%3C/svg%3E');"></div>
    </div>

    <!-- Intro Screen -->
    <div id="intro-screen" class="fixed inset-0 z-50 flex flex-col items-center justify-center bg-black text-white transition-opacity duration-1000">
        <!-- Intro Background also updated to Wolf for consistency -->
        <div class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1565192372309-883a936a43d9?q=80&w=2070&auto=format&fit=crop')] bg-cover bg-center opacity-40 animate-pulse"></div>
        <h1 class="font-display text-6xl md:text-8xl font-black tracking-tighter uppercase z-10 animate-bounce text-cyan-500 drop-shadow-[0_0_15px_rgba(6,182,212,0.8)]">
            КӨКСЕРЕК
        </h1>
        <p class="text-xl md:text-2xl mt-4 z-10 font-mono text-cyan-200">BIG GAME SHOW</p>
        <div class="mt-8 z-10 w-64 h-2 bg-gray-800 rounded overflow-hidden">
            <div class="h-full bg-cyan-500 animate-loading"></div>
        </div>
    </div>

    <!-- Main UI Container -->
    <div class="relative z-10 flex flex-col h-full opacity-0 transition-opacity duration-1000" id="main-app">
        
        <!-- Header -->
        <header class="flex justify-between items-center p-4 md:p-6 border-b border-cyan-500/30 bg-black/40 backdrop-blur-md">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 rounded-full bg-cyan-500 flex items-center justify-center shadow-[0_0_15px_rgba(6,182,212,0.6)]">
                    <span class="font-display font-bold text-black text-xl">K</span>
                </div>
                <div>
                    <h1 class="text-2xl font-display font-black uppercase tracking-widest text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-600">
                        MEGA GAME
                    </h1>
                    <p class="text-xs text-cyan-300/70 font-mono tracking-widest">МҰХТАР ӘУЕЗОВ ӘЛЕМІ</p>
                </div>
            </div>
            <div class="flex items-center space-x-2 bg-black/50 px-3 py-1 rounded-full border border-red-500/30">
                <span class="animate-pulse w-2 h-2 bg-red-500 rounded-full"></span>
                <span class="text-red-500 font-mono text-xs font-bold">LIVE ON AIR</span>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="flex-1 overflow-y-auto p-4 md:p-8 scrollbar-hide" id="content-area">
            <div class="max-w-6xl mx-auto">
                
                <!-- SECTION 1: HOME (BASTY) -->
                <div id="section-home" class="section-content active animate-fade-in">
                    <div class="space-y-8">
                        <div class="relative p-8 rounded-3xl overflow-hidden glass">
                            <div class="absolute top-0 left-0 w-2 h-full bg-cyan-500"></div>
                            <h2 class="font-display text-4xl md:text-6xl font-black uppercase text-white mb-6">Мұхтар Әуезов <span class="text-cyan-500">(1897–1961)</span></h2>
                            
                            <div class="grid md:grid-cols-2 gap-8">
                                <div class="space-y-4 text-gray-300 leading-relaxed font-light text-lg">
                                    <p>
                                        <strong class="text-white">Ұлы жазушы:</strong> Қазақ әдебиетінің классигі, ғалым, қоғам қайраткері. Бала кезінен Абай өлеңдерін жаттап, халық ауыз әдебиетімен сусындап өскен.
                                    </p>
                                    <p>
                                        <strong class="text-white">«Көксерек» повесі (1928-1929):</strong> Табиғат пен адам арасындағы күрделі байланысты суреттейтін терең философиялық туынды.
                                    </p>
                                    <div class="p-4 bg-cyan-900/20 border border-cyan-500/20 rounded-xl mt-4">
                                        <h3 class="font-bold text-cyan-400 mb-2"><i class="fas fa-lightbulb mr-2"></i>Қызықты дерек:</h3>
                                        <p class="italic text-sm">
                                            «Бірде мен қабырға күнтізбесін сатып алдым... қысқы түн, қар жамылған дала, түнде жортқан қасқыр... Міне, сол сурет Мұхтар Әуезовтің есіне кәнігі аңшылардан естіген әңгімелерін түсірген...» 
                                            <br/><span class="text-gray-500 text-xs text-right block mt-2">- Валентина Әуезованың естелігінен</span>
                                        </p>
                                    </div>
                                </div>
                                
                                <div class="relative h-64 md:h-auto rounded-xl overflow-hidden shadow-2xl border-2 border-white/10 group">
                                    <div class="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent z-10"></div>
                                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQLw5Xg2RJ1QQatzS-AqgGzABkSveVwh4uk3A&s" alt="Мұхтар Әуезов" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110">
                                    <div class="absolute bottom-4 left-4 z-20">
                                        <h3 class="text-2xl font-bold text-white">Мұхтар Әуезов</h3>
                                        <p class="text-cyan-400 text-sm">Ұлы суреткер</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="grid md:grid-cols-3 gap-4">
                            <div class="bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-cyan-500 transition-colors cursor-pointer group">
                                <div class="text-4xl mb-4 text-yellow-400 group-hover:scale-110 transition-transform"><i class="fas fa-book-open"></i></div>
                                <h4 class="font-bold text-xl text-white mb-2">Абай жолы</h4>
                                <p class="text-gray-400 text-sm">Әлемге әйгілі эпопея</p>
                            </div>
                            <div class="bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-cyan-500 transition-colors cursor-pointer group">
                                <div class="text-4xl mb-4 text-blue-400 group-hover:scale-110 transition-transform"><i class="fas fa-mountain"></i></div>
                                <h4 class="font-bold text-xl text-white mb-2">Қараш-Қараш</h4>
                                <p class="text-gray-400 text-sm">Тарихи оқиға ізімен</p>
                            </div>
                            <div class="bg-gray-800/50 p-6 rounded-2xl border border-gray-700 hover:border-cyan-500 transition-colors cursor-pointer group">
                                <div class="text-4xl mb-4 text-gray-400 group-hover:scale-110 transition-transform"><i class="fas fa-paw"></i></div>
                                <h4 class="font-bold text-xl text-white mb-2">Көксерек</h4>
                                <p class="text-gray-400 text-sm">Адам және Табиғат</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SECTION 2: QUIZ (TEST) -->
                <div id="section-quiz" class="section-content animate-fade-in">
                    <div class="flex flex-col items-center justify-center min-h-[50vh]">
                        <div class="w-full max-w-3xl glass rounded-3xl p-8 shadow-[0_0_50px_rgba(6,182,212,0.15)] relative overflow-hidden" id="quiz-container">
                            <!-- JS will inject content here -->
                        </div>
                    </div>
                </div>

                <!-- SECTION 3: BATTLE (BATTLE SIMULATOR) -->
                <div id="section-battle" class="section-content animate-fade-in">
                    <div class="w-full max-w-5xl mx-auto">
                        <div class="grid md:grid-cols-2 gap-8 mb-6">
                            <!-- Player Card (Akkaska) -->
                            <div id="player-card" class="p-6 rounded-2xl border-2 border-cyan-500 bg-cyan-900/20 shadow-[0_0_30px_rgba(6,182,212,0.3)] transition-all duration-300">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-2xl font-black text-cyan-400 uppercase">Аққасқа</h3>
                                    <i class="fas fa-shield-alt text-cyan-400 text-2xl"></i>
                                </div>
                                <div class="w-full bg-gray-700 h-4 rounded-full overflow-hidden mb-2">
                                    <div id="player-hp-bar" class="bg-cyan-500 h-full transition-all duration-500" style="width: 100%"></div>
                                </div>
                                <p id="player-hp-text" class="text-right font-mono text-cyan-200">100/100 HP</p>
                                <!-- Icons removed as requested -->
                            </div>

                            <!-- Enemy Card (Kokserek) -->
                            <div id="enemy-card" class="p-6 rounded-2xl border-2 border-gray-700 bg-gray-900/50 transition-all duration-300">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-2xl font-black text-red-500 uppercase">Көксерек</h3>
                                    <i class="fas fa-skull text-red-500 text-2xl"></i>
                                </div>
                                <div class="w-full bg-gray-700 h-4 rounded-full overflow-hidden mb-2">
                                    <div id="enemy-hp-bar" class="bg-red-500 h-full transition-all duration-500" style="width: 100%"></div>
                                </div>
                                <p id="enemy-hp-text" class="text-right font-mono text-red-200">100/100 HP</p>
                                <!-- Icons removed as requested -->
                            </div>
                        </div>

                        <!-- Battle Controls & Logs -->
                        <div class="glass rounded-2xl p-6">
                            <div id="battle-controls-area">
                                <div class="grid md:grid-cols-3 gap-6">
                                    <div class="md:col-span-2 space-y-3">
                                        <h4 class="text-gray-400 uppercase text-xs tracking-widest mb-2">Командалар</h4>
                                        <div class="flex gap-3">
                                            <button onclick="battleAction('bite')" id="btn-bite" class="flex-1 bg-gradient-to-br from-cyan-600 to-blue-700 py-4 rounded-xl font-bold hover:brightness-110 transition-all border border-cyan-400/30 shadow-lg active:scale-95 text-white">
                                                <i class="fas fa-tooth mr-2"></i> Тістеу
                                            </button>
                                            <button onclick="battleAction('heal')" id="btn-heal" class="flex-1 bg-gradient-to-br from-green-600 to-emerald-700 py-4 rounded-xl font-bold hover:brightness-110 transition-all border border-green-400/30 shadow-lg active:scale-95 text-white">
                                                <i class="fas fa-leaf mr-2"></i> Күш
                                            </button>
                                            <button onclick="battleAction('ultimate')" id="btn-ult" class="flex-1 bg-gradient-to-br from-yellow-600 to-orange-700 py-4 rounded-xl font-bold hover:brightness-110 transition-all border border-yellow-400/30 shadow-lg active:scale-95 text-white">
                                                <i class="fas fa-bolt mr-2"></i> Аран ашу
                                            </button>
                                        </div>
                                        <p id="battle-status" class="text-center text-sm text-gray-400 mt-2 animate-pulse">Сіздің кезегіңіз...</p>
                                    </div>
                                    
                                    <div id="battle-logs" class="bg-gray-900/80 rounded-xl p-4 h-40 overflow-y-auto font-mono text-sm border border-gray-700 shadow-inner text-cyan-100 scrollbar-hide">
                                        <!-- Logs go here -->
                                        <div class="mb-1 border-b border-gray-800 pb-1 text-cyan-100"><span class="text-gray-500 text-xs">[START]</span> Шайқас басталды! Аққасқа vs Көксерек</div>
                                    </div>
                                </div>
                            </div>
                            <!-- Game Over View (Hidden initially) -->
                            <div id="battle-gameover" class="hidden text-center py-8">
                                <h2 id="gameover-title" class="text-4xl font-black mb-4"></h2>
                                <button onclick="resetBattle()" class="bg-white text-black px-8 py-3 rounded-full font-bold hover:scale-105 transition-transform flex items-center mx-auto space-x-2">
                                    <i class="fas fa-redo"></i> <span>Қайта ойнау</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SECTION 4: OPEN QUESTION (OY-TOLGAU) -->
                <div id="section-open" class="section-content animate-fade-in">
                    <div class="max-w-4xl mx-auto">
                        <div class="glass p-8 rounded-3xl border border-purple-500/30 shadow-[0_0_40px_rgba(168,85,247,0.2)]">
                            <div class="flex items-center justify-between mb-6">
                                <div class="flex items-center space-x-3">
                                    <i class="fas fa-comment-dots text-purple-400 text-3xl"></i>
                                    <h2 class="text-2xl md:text-3xl font-bold text-white">Ашық сұрақ алаңы</h2>
                                </div>
                                <div class="flex space-x-2">
                                    <button onclick="prevOpenQuestion()" class="p-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-white transition-colors border border-gray-600"><i class="fas fa-chevron-left"></i></button>
                                    <span id="open-q-counter" class="px-4 py-2 bg-gray-900 rounded-lg text-purple-300 font-mono border border-gray-700 flex items-center">1/5</span>
                                    <button onclick="nextOpenQuestion()" class="p-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-white transition-colors border border-gray-600"><i class="fas fa-chevron-right"></i></button>
                                </div>
                            </div>
                    
                            <!-- Question Container -->
                            <div id="open-question-container" class="space-y-6">
                                <div class="bg-purple-900/20 p-6 rounded-xl border border-purple-500/20 animate-fade-in">
                                    <h3 class="text-xl font-semibold text-purple-200 mb-2">Талқылау тақырыбы:</h3>
                                    <p id="open-question-text" class="text-lg italic text-white min-h-[60px]">
                                        <!-- Question text inserted via JS -->
                                    </p>
                                </div>
                    
                                <textarea id="open-answer-input" placeholder="Өз ойыңызды осында жазыңыз..." class="w-full h-40 bg-gray-900/80 border border-gray-600 rounded-xl p-4 text-white focus:outline-none focus:border-purple-500 transition-colors resize-none"></textarea>
                    
                                <button onclick="submitOpenAnswer()" class="w-full bg-gradient-to-r from-purple-600 to-indigo-600 py-4 rounded-xl font-bold text-white hover:shadow-[0_0_20px_rgba(168,85,247,0.5)] transition-all transform hover:-translate-y-1">
                                    ЖАУАПТЫ ЖІБЕРУ
                                </button>
                            </div>

                            <!-- Result Container -->
                            <div id="open-question-result" class="hidden animate-fade-in">
                                <div class="flex items-center space-x-2 text-green-400 mb-4">
                                    <i class="fas fa-check-circle"></i>
                                    <span class="font-bold">Жауап қабылданды!</span>
                                </div>
                                <div class="bg-gray-800/60 p-6 rounded-xl mb-6">
                                    <h4 class="text-gray-400 text-sm mb-2">Сіздің жауабыңыз:</h4>
                                    <p id="user-answer-display" class="text-white italic"></p>
                                </div>
                                
                                <div class="bg-purple-900/30 p-6 rounded-xl border border-purple-500/30">
                                    <h4 class="text-purple-300 font-bold mb-3 flex items-center">
                                        <i class="fas fa-star mr-2"></i>
                                        Сарапшы пікірі (Идеалды жауап):
                                    </h4>
                                    <p id="expert-opinion-display" class="text-gray-200 leading-relaxed">
                                        <!-- Expert opinion inserted via JS -->
                                    </p>
                                </div>
                                
                                <div class="flex space-x-4 mt-6">
                                    <button onclick="resetOpenAnswer()" class="text-purple-400 underline hover:text-purple-300 text-sm">
                                        Жауапты өзгерту
                                    </button>
                                    <button onclick="nextOpenQuestion()" class="px-4 py-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-white text-sm transition-colors border border-gray-600 ml-auto">
                                        Келесі сұрақ <i class="fas fa-arrow-right ml-1"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SECTION 5: DEBATE -->
                <div id="section-debate" class="section-content animate-fade-in">
                    <div class="max-w-5xl mx-auto flex flex-col justify-center min-h-[50vh]">
                        <div class="text-center mb-10">
                            <span class="bg-red-600 text-white px-3 py-1 text-xs font-bold rounded uppercase tracking-widest">Live Debate</span>
                            <h2 class="font-display text-4xl md:text-5xl font-black mt-4 text-white">ТАБИҒАТ vs ТӘРБИЕ</h2>
                            <p class="text-gray-400 mt-2">Қайсысы күшті? Өз дауысыңызды беріңіз.</p>
                        </div>
                
                        <div class="grid md:grid-cols-2 gap-4 md:gap-8 relative">
                            <!-- VS Badge -->
                            <div class="absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 z-10 hidden md:flex w-16 h-16 bg-white rounded-full items-center justify-center font-black text-black border-4 border-gray-900 shadow-xl">
                                VS
                            </div>
                
                            <!-- Left Side -->
                            <div class="p-8 rounded-3xl border border-blue-500/30 glass flex flex-col h-full hover:bg-black/60 transition-colors">
                                <h3 class="text-xl font-bold uppercase mb-2 text-blue-400">ЖАҚТАУШЫ (Құрмаш позициясы)</h3>
                                <h4 class="text-3xl font-black text-white mb-6 leading-none">Тәрбие жеңеді</h4>
                                <div class="flex-1">
                                    <p class="text-gray-300 text-lg leading-relaxed mb-8">
                                        "Кез келген тіршілік иесіне мейірімділік танытса, ол жауап қатады. Көксерек кішкентайынан қолда өсті, оны үйретуге болар еді."
                                    </p>
                                </div>
                                <button onclick="vote('left')" id="btn-vote-left" class="w-full py-4 rounded-xl font-bold text-black uppercase tracking-widest transition-transform transform active:scale-95 bg-blue-500 hover:bg-blue-400 shadow-[0_0_20px_rgba(59,130,246,0.5)]">
                                    Осы жақты қолдаймын
                                </button>
                            </div>
                
                            <!-- Right Side -->
                            <div class="p-8 rounded-3xl border border-red-500/30 glass flex flex-col h-full hover:bg-black/60 transition-colors">
                                <h3 class="text-xl font-bold uppercase mb-2 text-red-400">ДАТТАУШЫ (Ауыл адамдары)</h3>
                                <h4 class="text-3xl font-black text-white mb-6 leading-none">Табиғат заңы (Тектілік)</h4>
                                <div class="flex-1">
                                    <p class="text-gray-300 text-lg leading-relaxed mb-8">
                                        "«Қасқырды қанша асырасаң да, тоғайға қарап ұлиды». Бұл – жыртқыш. Оның қанында жауыздық пен дала заңы бар."
                                    </p>
                                </div>
                                <button onclick="vote('right')" id="btn-vote-right" class="w-full py-4 rounded-xl font-bold text-black uppercase tracking-widest transition-transform transform active:scale-95 bg-red-500 hover:bg-red-400 shadow-[0_0_20px_rgba(239,68,68,0.5)]">
                                    Осы жақты қолдаймын
                                </button>
                            </div>
                        </div>
                
                        <!-- Progress Bar -->
                        <div class="mt-12 bg-gray-800 h-16 rounded-full overflow-hidden relative shadow-2xl border border-gray-600">
                            <div id="bar-left" class="absolute left-0 top-0 bottom-0 bg-blue-600 flex items-center pl-6 transition-all duration-1000" style="width: 45%">
                                <span id="percent-left" class="font-black text-2xl text-white">45%</span>
                            </div>
                            <div id="bar-right" class="absolute right-0 top-0 bottom-0 bg-red-600 flex items-center justify-end pr-6 transition-all duration-1000" style="width: 55%">
                                <span id="percent-right" class="font-black text-2xl text-white">55%</span>
                            </div>
                            <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                                <div class="w-1 h-full bg-white/20"></div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </main>

        <!-- Navigation Dock -->
        <nav class="p-4 border-t border-cyan-500/30 bg-black/60 backdrop-blur-lg">
            <div class="max-w-4xl mx-auto flex justify-between md:justify-center md:space-x-8">
                <button onclick="switchTab('home')" class="nav-btn active-tab flex flex-col items-center justify-center p-2 rounded-xl transition-all duration-300 w-16 md:w-24 group text-white" id="nav-home">
                    <i class="fas fa-book-open mb-1 text-lg group-hover:scale-110 transition-transform"></i>
                    <span class="text-[10px] md:text-xs font-bold uppercase tracking-wide">Басты</span>
                </button>
                <button onclick="switchTab('quiz')" class="nav-btn flex flex-col items-center justify-center p-2 rounded-xl transition-all duration-300 w-16 md:w-24 group text-gray-400 hover:text-white" id="nav-quiz">
                    <i class="fas fa-bolt mb-1 text-lg group-hover:scale-110 transition-transform"></i>
                    <span class="text-[10px] md:text-xs font-bold uppercase tracking-wide">Тест</span>
                </button>
                <button onclick="switchTab('battle')" class="nav-btn flex flex-col items-center justify-center p-2 rounded-xl transition-all duration-300 w-16 md:w-24 group text-gray-400 hover:text-white" id="nav-battle">
                    <i class="fas fa-khanda mb-1 text-lg group-hover:scale-110 transition-transform"></i>
                    <span class="text-[10px] md:text-xs font-bold uppercase tracking-wide">Айқас</span>
                </button>
                <button onclick="switchTab('open')" class="nav-btn flex flex-col items-center justify-center p-2 rounded-xl transition-all duration-300 w-16 md:w-24 group text-gray-400 hover:text-white" id="nav-open">
                    <i class="fas fa-comments mb-1 text-lg group-hover:scale-110 transition-transform"></i>
                    <span class="text-[10px] md:text-xs font-bold uppercase tracking-wide">Ой-толғау</span>
                </button>
                <button onclick="switchTab('debate')" class="nav-btn flex flex-col items-center justify-center p-2 rounded-xl transition-all duration-300 w-16 md:w-24 group text-gray-400 hover:text-white" id="nav-debate">
                    <i class="fas fa-microphone-alt mb-1 text-lg group-hover:scale-110 transition-transform"></i>
                    <span class="text-[10px] md:text-xs font-bold uppercase tracking-wide">Дебат</span>
                </button>
            </div>
        </nav>
    </div>

    <!-- JavaScript Logic -->
    <script>
        // --- 1. INTRO LOGIC ---
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                const intro = document.getElementById('intro-screen');
                const main = document.getElementById('main-app');
                intro.style.opacity = '0';
                setTimeout(() => intro.style.display = 'none', 1000);
                main.style.opacity = '1';
                renderQuiz(); // Init quiz
                loadOpenQuestion(); // Init open question
            }, 2500);
        });

        // --- 2. TAB SWITCHING ---
        function switchTab(tabName) {
            // Update Navigation Buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active-tab', 'text-white');
                btn.classList.add('text-gray-400');
            });
            const activeBtn = document.getElementById(`nav-${tabName}`);
            activeBtn.classList.add('active-tab', 'text-white');
            activeBtn.classList.remove('text-gray-400');

            // Show Content
            document.querySelectorAll('.section-content').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(`section-${tabName}`).classList.add('active');
        }

        // --- 3. QUIZ LOGIC (15 Questions) ---
        const quizQuestions = [
            { id: 1, question: "«Көксерек» повесі қай жылдары жазылды?", options: ["1925-1926 жж.", "1928-1929 жж.", "1930-1932 жж.", "1918-1920 жж."], correct: 1 },
            { id: 2, question: "Мұхтар Әуезовке шығарманы жазуға не түрткі болды?", options: ["Түсінде көрген аян", "Күнтізбедегі сурет", "Әкесінің айтқан аңызы", "Газеттегі мақала"], correct: 1 },
            { id: 3, question: "Көксеректің ақтық шайқастағы қарсыласы кім?", options: ["Құрмаш", "Саршұнақ", "Аққасқа төбет", "Қара қасқыр"], correct: 2 },
            { id: 4, question: "Құрмаш қасқырды не деп атады?", options: ["Бөлтірік", "Көкжал", "Көксерек", "Арлан"], correct: 2 },
            { id: 5, question: "Повесть кімнің зарымен аяқталады?", options: ["Құрмаштың анасының", "Ауыл ақсақалының", "Құрмаштың әжесінің", "Аңшы Қасеннің"], correct: 2 },
            { id: 6, question: "Мұхтар Әуезов қай жылы дүниеге келген?", options: ["1900 жылы", "1897 жылы", "1905 жылы", "1885 жылы"], correct: 1 },
            { id: 7, question: "Көксеректің ең алғашқы азығы не болды?", options: ["Қатырған нан", "Шикі ет", "Сүт", "Піскен сүйек"], correct: 1 },
            { id: 8, question: "Көксеректің серігі болған қасқырдың түсі?", options: ["Қара", "Көк", "Ақ", "Сарғыш"], correct: 2 },
            { id: 9, question: "Құрмаштың Көксеректі жақсы көруінің себебі?", options: ["Кішкентайынан асырағаны", "Әкесі сыйлағандықтан", "Қорыққандықтан", "Ауылдағы жалғыз жануар"], correct: 0 },
            { id: 10, question: "Көксерек үйір басшысы болу үшін кімді жеңді?", options: ["Көк шолақты", "Ақ қасқырды", "Аққасқаны", "Қара төбетті"], correct: 0 },
            { id: 11, question: "«Көксерек» шығармасының негізгі идеясы не?", options: ["Аңшылық кәсіпті насихаттау", "Адам мен табиғат арасындағы байланыс", "Ит пен қасқырдың достығы", "Ауыл өмірінің қиындығы"], correct: 1 },
            { id: 12, question: "Повесте оқиға өтетін негізгі жер атауы?", options: ["Шыңғыстау", "Қараадыр", "Сарыарқа", "Алтай"], correct: 1 },
            { id: 13, question: "Аққасқа итінің иесі кім?", options: ["Құрмаш", "Әже", "Қасен аңшы", "Ауыл молдасы"], correct: 2 },
            { id: 14, question: "М. Әуезовтің «Көксерек» әңгімесі негізінде түсірілген фильм қай жылы шықты?", options: ["1965", "1980", "1973", "1991"], correct: 2 },
            { id: 15, question: "Көксерек ауылдан кеткен соң, адамдарға неге шабуыл жасады?", options: ["Ашыққандықтан және кек алу үшін", "Аққасқадан қорыққандықтан", "Құрмашты іздегендіктен", "Жай ғана ермек үшін"], correct: 0 }
        ];
        
        let quizState = { current: 0, score: 0, finished: false, selected: null };

        function renderQuiz() {
            const container = document.getElementById('quiz-container');
            if (quizState.finished) {
                container.innerHTML = `
                    <div class="text-center relative z-10 py-10">
                        <i class="fas fa-trophy text-6xl text-yellow-400 mb-6 drop-shadow-[0_0_15px_rgba(250,204,21,0.5)] animate-bounce"></i>
                        <h3 class="text-4xl font-black text-white mb-2">ОЙЫН АЯҚТАЛДЫ!</h3>
                        <p class="text-gray-400 mb-8">Сіздің нәтижеңіз:</p>
                        <div class="text-8xl font-black text-transparent bg-clip-text bg-gradient-to-b from-cyan-300 to-blue-600 mb-8">
                            ${quizState.score}/${quizQuestions.length}
                        </div>
                        <button onclick="restartQuiz()" class="px-8 py-3 bg-cyan-600 hover:bg-cyan-500 text-black font-bold rounded-full transition-all flex items-center mx-auto space-x-2 shadow-[0_0_20px_rgba(6,182,212,0.4)]">
                            <i class="fas fa-redo"></i> <span>Қайта бастау</span>
                        </button>
                    </div>`;
            } else {
                const q = quizQuestions[quizState.current];
                let optionsHtml = q.options.map((opt, idx) => {
                    let btnClass = "bg-gray-800/40 border-gray-700 hover:bg-cyan-900/30 hover:border-cyan-500 hover:translate-x-2";
                    let icon = "";
                    
                    if (quizState.selected !== null) {
                        if (idx === q.correct) {
                            btnClass = "bg-green-500/20 border-green-500 text-green-100";
                            icon = '<i class="fas fa-check-circle text-green-400"></i>';
                        } else if (idx === quizState.selected) {
                            btnClass = "bg-red-500/20 border-red-500 text-red-100";
                            icon = '<i class="fas fa-times-circle text-red-400"></i>';
                        } else {
                            btnClass = "bg-gray-800/50 border-gray-700 opacity-50";
                        }
                    }

                    return `<button onclick="handleQuizAnswer(${idx})" class="w-full p-5 text-left rounded-xl border transition-all duration-200 flex justify-between items-center group ${btnClass}">
                        <span class="font-medium text-lg">${opt}</span>
                        ${icon}
                    </button>`;
                }).join('');

                container.innerHTML = `
                    <div class="relative z-10 animate-fade-in">
                        <div class="flex justify-between items-center mb-8">
                            <span class="text-cyan-400 font-mono text-sm tracking-widest">СҰРАҚ ${quizState.current + 1}/${quizQuestions.length}</span>
                            <span class="bg-cyan-900/50 px-3 py-1 rounded-full text-cyan-300 text-xs font-bold border border-cyan-500/30">INTELLECT MODE</span>
                        </div>
                        <h3 class="text-2xl md:text-3xl font-bold text-white mb-8 leading-tight">${q.question}</h3>
                        <div class="grid gap-4">${optionsHtml}</div>
                    </div>`;
            }
        }

        function handleQuizAnswer(idx) {
            if (quizState.selected !== null) return;
            quizState.selected = idx;
            if (idx === quizQuestions[quizState.current].correct) quizState.score++;
            renderQuiz();

            setTimeout(() => {
                if (quizState.current < quizQuestions.length - 1) {
                    quizState.current++;
                    quizState.selected = null;
                } else {
                    quizState.finished = true;
                }
                renderQuiz();
            }, 1000);
        }

        function restartQuiz() {
            quizState = { current: 0, score: 0, finished: false, selected: null };
            renderQuiz();
        }

        // --- 4. BATTLE LOGIC ---
        let battleState = { playerHp: 100, enemyHp: 100, turn: 'player', logs: [], gameOver: null };

        function updateBattleUI() {
            // HP Bars
            document.getElementById('player-hp-bar').style.width = `${battleState.playerHp}%`;
            document.getElementById('player-hp-text').innerText = `${battleState.playerHp}/100 HP`;
            document.getElementById('enemy-hp-bar').style.width = `${battleState.enemyHp}%`;
            document.getElementById('enemy-hp-text').innerText = `${battleState.enemyHp}/100 HP`;
            
            // Cards Active State
            const pCard = document.getElementById('player-card');
            const eCard = document.getElementById('enemy-card');
            if (battleState.turn === 'player') {
                pCard.classList.add('border-cyan-500', 'bg-cyan-900/20', 'shadow-[0_0_30px_rgba(6,182,212,0.3)]');
                pCard.classList.remove('border-gray-700', 'bg-gray-900/50');
                eCard.classList.remove('border-red-500', 'bg-red-900/20', 'shadow-[0_0_30px_rgba(239,68,68,0.3)]');
                eCard.classList.add('border-gray-700', 'bg-gray-900/50');
                document.getElementById('battle-status').innerText = "Сіздің кезегіңіз...";
                toggleButtons(false);
            } else {
                eCard.classList.add('border-red-500', 'bg-red-900/20', 'shadow-[0_0_30px_rgba(239,68,68,0.3)]');
                eCard.classList.remove('border-gray-700', 'bg-gray-900/50');
                pCard.classList.remove('border-cyan-500', 'bg-cyan-900/20', 'shadow-[0_0_30px_rgba(6,182,212,0.3)]');
                pCard.classList.add('border-gray-700', 'bg-gray-900/50');
                document.getElementById('battle-status').innerText = "Көксерек шабуылдауда...";
                toggleButtons(true);
            }

            // Logs
            const logsContainer = document.getElementById('battle-logs');
            logsContainer.innerHTML = battleState.logs.map((log, i) => 
                `<div class="mb-1 border-b border-gray-800 pb-1 last:border-0 text-cyan-100"><span class="text-gray-500 text-xs">[${i+1}]</span> ${log}</div>`
            ).join('');
            logsContainer.scrollTop = logsContainer.scrollHeight;

            // Game Over
            if (battleState.gameOver) {
                document.getElementById('battle-controls-area').classList.add('hidden');
                document.getElementById('battle-gameover').classList.remove('hidden');
                const title = document.getElementById('gameover-title');
                if (battleState.gameOver === 'win') {
                    title.innerText = "АҚҚАСҚА ЖЕҢДІ!";
                    title.className = "text-4xl font-black mb-4 text-green-400";
                } else {
                    title.innerText = "КӨКСЕРЕК ЖЕҢДІ!";
                    title.className = "text-4xl font-black mb-4 text-red-500";
                }
            } else {
                document.getElementById('battle-controls-area').classList.remove('hidden');
                document.getElementById('battle-gameover').classList.add('hidden');
            }
        }

        function toggleButtons(disabled) {
            ['btn-bite', 'btn-heal', 'btn-ult'].forEach(id => {
                const btn = document.getElementById(id);
                btn.disabled = disabled;
                btn.style.opacity = disabled ? '0.5' : '1';
                btn.style.cursor = disabled ? 'not-allowed' : 'pointer';
            });
        }

        function battleAction(type) {
            if (battleState.gameOver) return;
            
            let dmg = 0;
            let msg = "";

            if (type === 'bite') {
                dmg = Math.floor(Math.random() * 15) + 10;
                msg = `Аққасқа тістерін ақситып, ${dmg} жарақат салды!`;
            } else if (type === 'heal') {
                const heal = Math.floor(Math.random() * 20) + 10;
                battleState.playerHp = Math.min(100, battleState.playerHp + heal);
                battleState.logs.push(`Аққасқа күш жинап, ${heal} HP қалпына келтірді.`);
                battleState.turn = "enemy";
                updateBattleUI();
                setTimeout(enemyTurn, 1500);
                return;
            } else if (type === 'ultimate') {
                dmg = Math.floor(Math.random() * 30) + 15;
                msg = `Аққасқа Көксеректің алқымынан алды! КРИТИКАЛЫҚ СОҚҚЫ: ${dmg}!`;
            }

            battleState.enemyHp = Math.max(0, battleState.enemyHp - dmg);
            battleState.logs.push(msg);

            if (battleState.enemyHp <= 0) {
                battleState.gameOver = 'win';
                battleState.logs.push("ЖЕҢІС! Көксерек жеңілді. Ауыл тынышталды.");
                updateBattleUI();
            } else {
                battleState.turn = "enemy";
                updateBattleUI();
                setTimeout(enemyTurn, 1500);
            }
        }

        function enemyTurn() {
            if (battleState.gameOver) return;
            
            const dmg = Math.floor(Math.random() * 20) + 5;
            battleState.playerHp = Math.max(0, battleState.playerHp - dmg);
            battleState.logs.push(`Көксерек ырылдап тап берді! Аққасқаға ${dmg} зақым тиді.`);

            if (battleState.playerHp <= 0) {
                battleState.gameOver = 'lose';
                battleState.logs.push("ЖЕҢІЛІС... Көксерек басым түсті.");
            } else {
                battleState.turn = "player";
            }
            updateBattleUI();
        }

        function resetBattle() {
            battleState = { playerHp: 100, enemyHp: 100, turn: 'player', logs: ["Шайқас қайта басталды!"], gameOver: null };
            updateBattleUI();
        }

        // --- 5. OPEN QUESTION LOGIC (5 Questions) ---
        const openQuestions = [
            {
                id: 1,
                text: "Неге Құрмаш ауыл адамдарының ескертуіне қарамастан, Көксеректі қорғап қалды? Бұл оның мейірімділігі ме, әлде аңғалдығы ма?",
                expert: "Құрмаш – таза жүректі, мейірімді бала. Ол Көксеректі жау емес, досы, қорғанышы деп қабылдады. Оның әрекеті аңғалдықтан бұрын, тіршілік иесіне деген шексіз сүйіспеншіліктен туындады. Автор осы арқылы баланың кіршіксіз әлемі мен жыртқыштың өзгермес табиғаты арасындағы трагедиялық қайшылықты көрсеткісі келді."
            },
            {
                id: 2,
                text: "Ауыл адамдарының «Ұры. Асырасаң да, мал болмайды. Тұқымы жау емес пе?» деген сөзінің астарында қандай шындық жатыр?",
                expert: "Бұл сөздер халықтық даналық пен тәжірибеге негізделген. Ауыл адамдары табиғат заңын жақсы біледі: қасқыр - түз тағысы, оны қолға үйрету мүмкін емес. Бұл ескерту тек қауіп туралы емес, табиғи тепе-теңдікті бұзбау керектігін меңзейді."
            },
            {
                id: 3,
                text: "Көксеректің адамдарға шабуыл жасауына не себеп болды? Бұл кек алу ма, әлде жыртқыштық түйсік пе?",
                expert: "Бұл екеуінің қосындысы. Бір жағынан, адамдар оның ұяластарын өлтіріп, оған қатыгездік танытты (тірсегін қию). Екінші жағынан, еркіндікке шыққан соң оның бойындағы жабайы түйсік оянды. Қасқырдың табиғаты - жортуыл мен шабуыл."
            },
            {
                id: 4,
                text: "Аққасқа мен Көксеректің айқасы нені бейнелейді? Бұл жай ғана екі жануардың төбелесі ме?",
                expert: "Бұл символикалық мәні бар көрініс. Аққасқа - адамға қызмет ететін, адалдықтың символы болса, Көксерек - бағынбайтын, жабайы, қатыгез күштің бейнесі. Бұл шайқас - өркениет пен жабайы табиғаттың, жақсылық пен зұлымдықтың тартысы."
            },
            {
                id: 5,
                text: "Шығарма соңындағы әжейдің зары қалай әсер етті? Автор осы арқылы қандай ой түйді?",
                expert: "Әжейдің зары - шығарманың кульминациясы әрі түйіні. Бұл тек жоқтау емес, табиғатқа жасалған қиянаттың зардабы. Автор осы арқылы табиғат заңын бұзудың соңы орны толмас қайғыға әкелетінін ескертеді. Құрмаш - сол қателіктің жазықсыз құрбаны."
            }
        ];

        let currentOpenQIndex = 0;
        let userAnswers = {}; // Store user answers by question ID

        function loadOpenQuestion() {
            const q = openQuestions[currentOpenQIndex];
            document.getElementById('open-q-counter').innerText = `${currentOpenQIndex + 1}/${openQuestions.length}`;
            document.getElementById('open-question-text').innerText = `"${q.text}"`;
            
            // Restore answer if exists, otherwise clear
            const savedAns = userAnswers[q.id] || "";
            document.getElementById('open-answer-input').value = savedAns;

            // Reset UI state (show input, hide result) logic needs to handle already submitted state?
            // For simplicity, we just show input form always when switching, or we could track "submitted" state per question.
            // Let's reset to input mode when switching for better UX to edit/view.
            // FIXED: Removed reference to non-existent 'open-question-form'
            document.getElementById('open-question-container').classList.remove('hidden');
            document.getElementById('open-question-result').classList.add('hidden');
        }

        function nextOpenQuestion() {
            if (currentOpenQIndex < openQuestions.length - 1) {
                currentOpenQIndex++;
                loadOpenQuestion();
            }
        }

        function prevOpenQuestion() {
            if (currentOpenQIndex > 0) {
                currentOpenQIndex--;
                loadOpenQuestion();
            }
        }

        function submitOpenAnswer() {
            const txt = document.getElementById('open-answer-input').value;
            if (!txt.trim()) return;
            
            const q = openQuestions[currentOpenQIndex];
            userAnswers[q.id] = txt; // Save answer

            document.getElementById('user-answer-display').innerText = `"${txt}"`;
            document.getElementById('expert-opinion-display').innerText = q.expert;
            
            document.getElementById('open-question-container').classList.add('hidden');
            document.getElementById('open-question-result').classList.remove('hidden');
        }

        function resetOpenAnswer() {
            const q = openQuestions[currentOpenQIndex];
            document.getElementById('open-answer-input').value = userAnswers[q.id] || "";
            document.getElementById('open-question-container').classList.remove('hidden');
            document.getElementById('open-question-result').classList.add('hidden');
        }

        // --- 6. DEBATE LOGIC ---
        let votes = { left: 45, right: 55 };
        let hasVoted = false;

        function vote(side) {
            if (hasVoted) return;
            
            if (side === 'left') votes.left++;
            else votes.right++;
            
            hasVoted = true;
            
            // Disable buttons
            const btnLeft = document.getElementById('btn-vote-left');
            const btnRight = document.getElementById('btn-vote-right');
            
            btnLeft.disabled = true;
            btnLeft.classList.add('bg-gray-600', 'cursor-not-allowed', 'opacity-50');
            btnLeft.innerText = "Дауыс берілді";
            
            btnRight.disabled = true;
            btnRight.classList.add('bg-gray-600', 'cursor-not-allowed', 'opacity-50');
            btnRight.innerText = "Дауыс берілді";
            
            updateBars();
        }

        function updateBars() {
            const total = votes.left + votes.right;
            const leftPercent = Math.round((votes.left / total) * 100);
            const rightPercent = 100 - leftPercent;

            document.getElementById('bar-left').style.width = `${leftPercent}%`;
            document.getElementById('percent-left').innerText = `${leftPercent}%`;
            
            document.getElementById('bar-right').style.width = `${rightPercent}%`;
            document.getElementById('percent-right').innerText = `${rightPercent}%`;
        }

    </script>
</body>
</html>